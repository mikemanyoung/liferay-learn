<!DOCTYPE html><html><head><meta charset="UTF-8"><meta content="minimum-scale=1.0, width=device-width" name="viewport"><meta name="description" content="Let's get started!"><title>Exercise: Your First Service - Liferay Learning</title><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,400,600,700|Roboto+Mono"><link rel="stylesheet" href="/vendor/galano/galano.css"><link rel="stylesheet" href="/vendor/icon-12/icon-12.css"><link rel="stylesheet" href="/vendor/icon-16/icon-16.css"><link rel="stylesheet" href="/vendor/senna/senna.css"><link rel="stylesheet" href="/vendor/codemirror/lib/codemirror.css"><link rel="stylesheet" href="/vendor/codemirror/theme/dracula.css"><script src="/js/bundles/shared.electric.js"></script><script src="/vendor/senna/senna.js"></script><script src="/vendor/codemirror/lib/codemirror.js"></script><script src="/vendor/codemirror/mode/clike/clike.js"></script><script src="/vendor/codemirror/mode/css/css.js"></script><script src="/vendor/codemirror/mode/groovy/groovy.js"></script><script src="/vendor/codemirror/mode/javascript/javascript.js"></script><script src="/vendor/codemirror/mode/shell/shell.js"></script><script src="/vendor/codemirror/mode/swift/swift.js"></script><script src="/vendor/codemirror/mode/xml/xml.js"></script><link rel="stylesheet" href="/styles/main.css"></head><body data-senna=""><div data-senna-surface="" id="wrapper"><div class="senna-loading-bar"></div><div id="pageComponent"><div class="main"><main class="guide"><div class="docs"><div class="container-hybrid"><div class="docs-guide row"><div class="docs-content col-xs-16 col-md-9"><div class="guide-content"><h6>Let's get started!</h6><article id="1"><h2>Install Liferay Developer Tools</h2><p>In order to follow the exercise in the video, you’ll need to install the following:</p><ul><li><a href="https://web.liferay.com/get-ee-trial/downloads/developer-studio">Liferay Developer Studio</a></li><li><a href="https://customer.liferay.com/documentation/7.0/develop/tutorials/-/official_documentation/tutorials/installing-liferay-workspace">Liferay Workspace</a></li></ul><aside><h6><span class="icon-16-star"></span> Pro Tip</h6><p>If this exercise text leaves questions open, the next chapter contains a step-by-step walkthrough video of installing Liferay Developer Studio and Liferay Workspace, as well as the exercise itself. Feel free to watch it during the exercise or if you run into problems.</p></aside></article><article id="2"><h2>Exercise Overview</h2><p>For the first demonstration, we’ll create three projects:</p><ul><li>a simple API for the service</li><li>a service implementation</li><li>a client to call the service</li></ul><p>As we want to be as simple as possible, we’ll stick with the most basic components. Liferay comes with a shell, called <code>Gogo Shell</code>. The Gogo Shell allows us to interact with the OSGi container and execute the client we are creating to run our service.</p></article><article id="3"><h2>Service API</h2><p>To start, we’ll create a simple API using the wizards provided by Liferay Developer Studio.</p><h6>Create the Project</h6><ul><li><code>Open</code> Liferay Developer Studio</li><li>Create a <code>Liferay Module Project</code></li><li>Name the project: <code>“helloworld-api”</code></li><li>For <code>Project Template Name</code>, select <code>“api”</code> from the drop down</li><li>Click <code>Next</code></li></ul><h6>Complete the Module Details</h6><ul><li>Component Class Name: <code>HelloService</code></li><li>Package Name: <code>com.liferay.university.hello.api</code></li><li>Click <code>Finish</code></li></ul><h6>Create the Service API</h6><ul><li>Open <code>HelloService.java</code></li><li>Add the <code>hello</code> method signature below</li></ul><div class="code-container"><button class="btn btn-sm btn-copy"><span class="icon-12-overlap"></span></button><pre><code class="code" data-mode="text/x-java" ref="code">package com.liferay.university.hello.api;

public interface HelloService {
    String hello(String parameter);
}</code></pre></div><p>Liferay Developer Studio, along with Liferay Workspace, will create a proper project structure for you, including the following <code>bnd.bnd</code> file:</p><div class="code-container"><button class="btn btn-sm btn-copy"><span class="icon-12-overlap"></span></button><pre><code class="code" data-mode="text" ref="code">Bundle-Name: helloworld-api
Bundle-SymbolicName: com.liferay.university.hello.api
Bundle-Version: 1.0.0
Export-Package: com.liferay.university.hello.api</code></pre></div><h6>Deploy to Your Container</h6><p>When this project is built, we’ll have a bundle that we can deploy to any OSGi container. Let's start Liferay within Liferay Developer Studio and use the OSGi container that is embedded into Liferay.</p><p><img src="../../images/osgi-basics/Start_Liferay.png" alt="alt img"></p><h6>Verify Your Service in the Gogo Shell</h6><ul><li>Open a telnet client on localhost, port 11311, to access Gogo Shell</li><li>Type g! lb helloworld to list all the bundles (lb) that have “helloworld” in their name</li></ul><div class="code-container"><button class="btn btn-sm btn-copy"><span class="icon-12-overlap"></span></button><pre><code class="code" data-mode="text" ref="code">g! lb helloworld
START LEVEL 20
   ID|State     |Level|Name
  590|Active    |    1|helloworld-api (1.0.0)</code></pre></div></article><article id="4"><h2>Service Implementation</h2><h6>Create</h6><p>Now create a second project with the service implementation.</p><ul><li>Create a new <code>service</code> project in Liferay Developer Studio.</li><li>Name the project <code>helloworld-service</code></li></ul><p>When the project is created, take a look at the <code>HelloServiceImpl</code> class:</p><div class="code-container"><button class="btn btn-sm btn-copy"><span class="icon-12-overlap"></span></button><pre><code class="code" data-mode="text/x-java" ref="code">package com.liferay.university.hello.impl;

import com.liferay.university.hello.api.HelloService;

import org.osgi.service.component.annotations.Component;

@Component
public class HelloServiceImpl implements HelloService {
    @Override
    public String hello(String parameter) {
     return parameter;
    }
}</code></pre></div><p>Notice that the class “HelloService” is showing up as unresolved. To fix this, let’s import our interface.</p><p>The gradle implementation in Liferay Workspace makes other modules from the same workspace easily available.</p><ul><li>Open build.gradle</li><li>Add the following line to the existing dependencies:</li></ul><div class="code-container"><button class="btn btn-sm btn-copy"><span class="icon-12-overlap"></span></button><pre><code class="code" data-mode="text" ref="code">compileOnly project(":modules:helloworld-api")</code></pre></div><ul><li>Next, we need to get gradle to pick up the changed dependencies.</li><li>Right-click and choose “Gradle/Refresh Gradle Project”</li></ul><p>The resulting project will automatically deploy to Liferay, ending up with both of our projects being available:</p><div class="code-container"><button class="btn btn-sm btn-copy"><span class="icon-12-overlap"></span></button><pre><code class="code" data-mode="text" ref="code">g! lb helloworld
START LEVEL 20
   ID|State     |Level|Name
  590|Active    |   1|helloworld-api (1.0.0)
  591|Active    |   1|helloworld-service (1.0.0)</code></pre></div></article><article id="5"><h2>Calling the Service</h2><p>To call the service, let’s build a quick and dirty Gogo-Shell command that utilizes our service:</p><ul><li>Create another project of type “service”</li><li>Name the project “helloworld-command”</li></ul><p><strong>Note:</strong> This bundle will also depend on helloworld-api, just like the service implementation. Add the same dependency as above to build.gradle.Next, let’s call the relevant HelloService implementation and display the results in Gogo Shell.</p><div class="code-container"><button class="btn btn-sm btn-copy"><span class="icon-12-overlap"></span></button><pre><code class="code" data-mode="text/x-java" ref="code">package com.liferay.university.command;

import com.liferay.university.hello.api.HelloService;
import org.osgi.service.component.annotations.Component;
import org.osgi.service.component.annotations.Reference;

@Component(
       immediate=true,
       service = Object.class,
       property = {
        "osgi.command.function=say",
        "osgi.command.scope=custom"
       }
     )
public class HelloWorldCommand {
    
    public void say(String what) {
     System.out.println(helloService.hello(what));
    }
    
    @Reference    
    private HelloService helloService;
}</code></pre></div><p>The @Component declaration will make sure that we can easily use this class as a command in Gogo Shell. Let’s try this: On Gogo Shell, validate that your service is deployed and active:</p><p>Let’s try this: Validate that your service is deployed and active in Gogo Shell:</p><div class="code-container"><button class="btn btn-sm btn-copy"><span class="icon-12-overlap"></span></button><pre><code class="code" data-mode="text" ref="code">g! lb helloworld
START LEVEL 20
   ID|State     |Level|Name
  590|Active    |   1|helloworld-api (1.0.0)
  591|Active    |   1|helloworld-service (1.0.0)
  592|Active    |   1|helloworld-command (1.0.0)</code></pre></div><p>Now type:</p><div class="code-container"><button class="btn btn-sm btn-copy"><span class="icon-12-overlap"></span></button><pre><code class="code" data-mode="text" ref="code">g! say hello
hello</code></pre></div><p><strong>Congratulations,</strong> your first and simplest possible OSGi Declarative Service.</p></article><article id="6"><h2>Dependency Injection Through OSGi</h2><p>Let’s use this simple code for further experimentation with Gogo Shell and mess with the runtime. Note: Replace “591” with the ID for your service from Gogo Shell.</p><div class="code-container"><button class="btn btn-sm btn-copy"><span class="icon-12-overlap"></span></button><pre><code class="code" data-mode="text" ref="code">g! stop 591
g! say hello
gogo: CommandNotFoundException: Command not found: say</code></pre></div><h6>What Happened?</h6><div class="code-container"><button class="btn btn-sm btn-copy"><span class="icon-12-overlap"></span></button><pre><code class="code" data-mode="text" ref="code">g! lb helloworld
START LEVEL 20
   ID|State     |Level|Name
  590|Active    |   1|helloworld-api (1.0.0)
  591|Resolved  |   1|helloworld-service (1.0.0)
  592|Resolved  |   1|helloworld-command (1.0.0)</code></pre></div><h6>Again: What Happened?</h6><p>The helloworld-command service has a dependency on “helloworld-service” that is no longer satisfied. Thus, the OSGi runtime has not only stopped the service implementation, but also the helloworld-command service.</p><p><strong>Next,</strong> start the helloworld-service bundle again and see if helloworld-command is restarted as well.</p><h5>OSGi Bundle Lifecycle</h5><p>This brings us to the lifecycle of an OSGi bundle. As soon as you have deployed a bundle into an OSGi runtime, the runtime will attempt to resolve all available dependencies:</p><p><img src="../../images/osgi-basics/OSGi_Bundle_Cycle.png" alt="alt img"></p><p>Let’s keep things simple with this first exercise, and make it more interesting in the next exercise. We’ll introduce a second implementation for our API and see if the new deployment meets your expectations.</p></article><input type="hidden" value="Exercise: Your First Service"><input type="hidden" value="Liferay Learning"></div></div><nav class="col-xs-16 col-md-offset-2 col-md-5"><div class="docs-nav-container"><div class="affix-top docs-nav"><div ref="readingContainer"></div></div></div></nav></div></div></div></main></div></div><script src="/js/bundles/vUJjd.js"></script><script>var data = '{"pageLocation":"index.children.docs.children.osgi-basics.children.your-first-service","site":{"title":"Liferay Learning","googleAnalytics":"UA-37033501-5","index":{"title":"Home","description":"Let\'s Learn!","srcFilePath":"src/pages/index.soy","id":"pages","location":"/./","url":"/./","children":{"docs":{"children":{"empty":{"title":"empty page","description":"empty page","layout":"guide","icon":"cloud","weight":4,"srcFilePath":"src/pages/docs/empty.md","id":"empty","location":"/docs/empty.html","url":"/docs/empty.html"},"foundational-concepts":{"children":{"04-usermanagement":{"title":"User Management","description":"User Management","layout":"guide","icon":"cloud","weight":4,"srcFilePath":"src/pages/docs/foundational-concepts/04-usermanagement.md","id":"04-usermanagement","location":"/docs/foundational-concepts/04-usermanagement.html","url":"/docs/foundational-concepts/04-usermanagement.html"},"10-pagemanagement":{"title":"Page Management","description":"Page Management","layout":"guide","icon":"cloud","weight":4,"srcFilePath":"src/pages/docs/foundational-concepts/10-pagemanagement.md","id":"10-pagemanagement","location":"/docs/foundational-concepts/10-pagemanagement.html","url":"/docs/foundational-concepts/10-pagemanagement.html"},"30-personal-space":{"title":"Personal Pages","description":"Personal Pages","layout":"guide","icon":"cloud","weight":4,"srcFilePath":"src/pages/docs/foundational-concepts/30-personal-space.md","id":"30-personal-space","location":"/docs/foundational-concepts/30-personal-space.html","url":"/docs/foundational-concepts/30-personal-space.html"}},"childIds":["10-pagemanagement","30-personal-space","04-usermanagement"]},"osgi-basics":{"children":{"create-another-service":{"title":"Deploy","description":"Let\'s get started!","layout":"guide","icon":"cloud","weight":4,"srcFilePath":"src/pages/docs/osgi-basics/create-another-service.md","id":"create-another-service","location":"/docs/osgi-basics/create-another-service.html","url":"/docs/osgi-basics/create-another-service.html"},"your-first-service":{"title":"Exercise: Your First Service","description":"Let\'s get started!","icon":"flash","layout":"guide","weight":1,"srcFilePath":"src/pages/docs/osgi-basics/your-first-service.md","id":"your-first-service","location":"/docs/osgi-basics/your-first-service.html","url":"/docs/osgi-basics/your-first-service.html","active":true}},"title":"Deploy","description":"Let\'s get started!","layout":"guide","icon":"cloud","weight":4,"srcFilePath":"src/pages/docs/osgi-basics/index.md","id":"osgi-basics","location":"/docs/osgi-basics/","url":"/docs/osgi-basics/","childIds":["your-first-service","create-another-service"],"active":true}},"title":"Docs","description":"Everything you need to know to get started.","srcFilePath":"src/pages/docs/index.soy","id":"docs","location":"/docs/","url":"/docs/","childIds":["osgi-basics","empty",null],"active":true}},"childIds":["docs"]},"basePath":"","topbar":[{"href":"/docs/","label":"Docs","selected":true}]}}'; if (typeof electric !== 'undefined') {electric.init(data);}else {document.addEventListener('DOMContentLoaded', function() {electric.init(data);});}</script></div><script data-senna-track="permanent" src="/js/electric/electric.js"></script></body></html>